Array.prototype.getRandomValue=function(){return this[Math.floor(Math.random()*this.length)]},Array.prototype.shuffle=function(){for(var e,o,n=this.length;n;e=Math.floor(Math.random()*n),o=this[--n],this[n]=this[e],this[e]=o);},Array.prototype.pushIfNotExists=function(e){-1==this.indexOf(e)&&this.push(e)},define("sudokujs/arrayExtensions",function(){}),define("app/loader.vm",["sudokujs/arrayExtensions"],function(){var e=function(){var e=[],o=ko.observable(),n=ko.observable(!1),r=ko.observable(),t=function(){for(var o=0;9>o;o++)e[o]=ko.observable(o+1);i()},i=function(){var o=[1,2,3,4,5,6,7,8,9];o.shuffle();for(var n=0;9>n;n++)e[n](o[n])},u=function(e){i(),o(e),n(!0)},s=function(){r.notifySubscribers()};return t(),{content:o,numbers:e,isVisible:n,isBlocked:r,show:u,retry:s}}();return e}),define("app/timer.vm",[],function(){var e=function(){var e,o=ko.observable(0),n=ko.observable(0),r=function(e){return 10>e?"0"+e:e},t=ko.computed(function(){return r(n())+":"+r(o())}),i=function(){o(0),n(0),clearTimeout(e),a()},u=function(){a()},s=function(){clearTimeout(e)},a=function(){60==o()&&(o(0),n(n()+1)),e=setTimeout(function(){o(o()+1),a()},1e3)};return i(),{time:t,reset:i,play:u,pause:s}}();return e}),define("app/board.vm",[],function(){var e=function(e){var o,n,r=function(){var r,t,i,u;for(o=[],n=!0,r=0;3>r;r++)for(o[r]={boxes:[]},t=0;3>t;t++)for(o[r].boxes[t]={rowCells:[]},i=0;3>i;i++)for(o[r].boxes[t].rowCells[i]={cells:[]},u=0;3>u;u++)o[r].boxes[t].rowCells[i].cells[u]={cell:ko.observable(e.cells[3*r+i][3*t+u])}};return r(),{stylesEnabled:n,rowBoxes:o}};return e}),define("app/modal.vm",[],function(){var e=function(){var e=ko.observable(!1),o=ko.observable(!1),n=ko.observable(),r=function(o){n(o),e(!0)},t=function(){e(!1),o(!1)};return{show:r,close:t,isVisible:e,isTextSelectable:o,content:n}}();return e}),define("sudokujs/cell",[],function(){var e=function(e,o,n){var r,t=[0,0,0,0,0,0,0,0,0,0],i={},u=function(){var e,o=[];for(e=1;9>=e;e++)0==t[e]&&o.push(e);return o},s=function(){return r},a=function(i){return t[i]?0:(r&&n.publish("numberChanged-"+e+o,[r,-1]),i&&n.publish("numberChanged-"+e+o,[i,1]),r=i,1)},l=function(e){var o,n;o=e[0],n=e[1],t[o]+=n},f=function(){var o;for(o=0;9>o;o++)n.subscribe("numberChanged-"+e+o,i.handleChange)},d=function(){var e;for(e=0;9>e;e++)n.subscribe("numberChanged-"+e+o,i.handleChange)},c=function(){var r,t,u,s;for(r=3*Math.floor(e/3),t=3*Math.floor(o/3),u=r;r+3>u;u++)for(s=t;t+3>s;s++)n.subscribe("numberChanged-"+u+s,i.handleChange)};return i={getPossibleNumbers:u,getNumber:s,setNumber:a,handleChange:l},f(),d(),c(),i};return e}),define("sudokujs/pubsub",[],function(){var e=function(){var e={};return{publish:function(o){var n=[].slice.call(arguments,1);e[o]||(e[o]=[]);for(var r=0,t=e[o].length;t>r;r++)e[o][r].apply(null,n)},subscribe:function(o,n){e[o]?e[o].push(n):e[o]=[n]}}};return e}),define("sudokujs/board",["./cell","./pubsub","./arrayExtensions"],function(e,o){var n=function(n){var r,t,i=function(){t=o(),u(),n&&s(n)},u=function(){var o,n;for(r=[],o=0;9>o;o++)for(r[o]=[],n=0;9>n;n++)r[o][n]=e(o,n,t)},s=function(e){var o,n;for(o=0;9>o;o++)for(n=0;9>n;n++)r[o][n].setNumber(e.cells[o][n].getNumber())},a=function(){var e,o;for(e=0;9>e;e++)for(o=0;9>o;o++)if(!r[e][o].getNumber())return!1;return!0};return i(),{cells:r,isFull:a}};return n}),define("sudokujs/boardMapper",[],function(){var e=function(){var e=function(e,o){var n;for(n=0;81>n;n++)o[n]&&e.cells[Math.floor(n/9)][n%9].setNumber(o[n])},o=function(e){var o,n,r=[];for(o=0;9>o;o++)for(n=0;9>n;n++)r[9*o+n]=e.cells[o][n].getNumber();return r},n=function(o,n){var r,t=[];for(r=0;81>r;r++)if("."!=n[r])t[r]=n[r];else{if("."!=n[r])throw"Not valid word";t[r]=void 0}e(o,t)},r=function(e){var n,r,t=[];for(r=o(e),n=0;81>n;n++)t[n]=r[n]?r[n]:".";return t};return{mapFromArray:e,mapFromString:n,mapToArray:o,mapToString:r}}();return e}),define("sudokujs/sudokuWorker",["./board","./boardMapper"],function(e,o){var n=function(n){var r,t,i,u,s=function(){t=!1,r=new Worker(n),r.onmessage=d},a=function(){r.terminate()},l=function(e,o){t=!0,i=o,r.postMessage({cmd:"generate",difficulty:e})},f=function(e,n,i){t=!0,u=i,r.postMessage({cmd:"solve",numberOfSolutions:n,board:o.mapToString(e)})},d=function(n){var r,s,a;switch(s=n.data,r=e(),o.mapFromString(r,s.board),s.cmd){case"generate":t=!1,i(r);break;case"solve":t=!1,a=parseInt(s.numberOfSolutions),u(r,a)}};return{isBusy:t,start:s,abort:a,generate:l,solve:f}}("www/scripts/sudokujs/sudokuWorker.src.js");return n}),define("sudokujs/boardDifficulty",{Easy:32,Medium:27,Hard:24}),define("app/game.vm",["./timer.vm","./board.vm","./modal.vm","sudokujs/sudokuWorker","sudokujs/board","sudokujs/boardDifficulty"],function(e,o,n,r,t,i){var u=function(){var u,s,a,l,f={},d=ko.observable(),c=ko.observable(),b=ko.observable(),m=ko.observable(),p=function(){c(!0),b(!0),m(!1),l=!1,u=t(),a=o(u),r.start(),setTimeout(function(){k("Medium")},1e3)},v=function(){b(!0),r.solve(s,1,M)},k=function(e){b(!0),d(e),r.generate(i[ko.unwrap(d)],y)},h=function(){m(!0),e.pause()},g=function(){m(!1),e.play()},w=function(){u.isFull()?l?n.show("Confucius: 'I hate cheaters'"):(e.pause(),n.show("Congrats! Awesome job")):n.show("Not finished yet! You missed some spots")},y=function(n){u=n,s=t(n),f.BoardViewModel=o(u),l=!1,ko.cleanNode($("#sudoku-normal-board")[0]),ko.applyBindings(f,$("#sudoku-normal-board")[0]),e.reset(),b(!1)},M=function(e){u=e,s=t(e),f.BoardViewModel=o(u),l=!0,ko.cleanNode($("#sudoku-normal-board")[0]),ko.applyBindings(f,$("#sudoku-normal-board")[0]),b(!1)};return p(),f={generate:k,solve:v,play:g,finish:w,pause:h,isVisible:c,isBusy:b,isPaused:m,currentDifficulty:d,TimerViewModel:e,BoardViewModel:a}}();return u}),define("app/inputModal.vm",[],function(){var e=function(){var e={},o=ko.observable(!1),n=ko.observable(),r=ko.observable(),t=function(){},i=function(e){n(e),o(!0)},u=function(){o(!1),e.inputHandler(r())};return e={show:i,close:u,isVisible:o,content:n,input:r,inputHandler:t}}();return e}),define("app/gameEditor.vm",["./board.vm","./modal.vm","./inputModal.vm","sudokujs/sudokuWorker","sudokujs/boardMapper","sudokujs/board","sudokujs/boardDifficulty"],function(e,o,n,r,t,i,u){var s,a,l,f={},d=ko.observable(),c=ko.observable(),b=function(){d(!1),c(!1),l=1e3,s=i(),a=e(s)},m=function(){c(!0),r.solve(s,1,w)},p=function(){c(!0),r.solve(s,l,y)},v=function(){c(!0),r.generate(u.Medium,w)},k=function(n){s=i();try{t.mapFromString(s,n)}catch(r){o.show("Something went wrong. Verify input")}f.BoardViewModel=e(s),f.BoardViewModel.stylesEnabled=!1,ko.cleanNode($("#sudoku-editor-board")[0]),ko.applyBindings(f,$("#sudoku-editor-board")[0])},h=function(){n.inputHandler=k,n.show("Enter board in string format")},g=function(){var e=t.mapToString(s);o.isTextSelectable(!0),o.show("Copy this: "+e.join(""))},w=function(o){s=o,f.BoardViewModel=e(s),f.BoardViewModel.stylesEnabled=!1,ko.cleanNode($("#sudoku-editor-board")[0]),ko.applyBindings(f,$("#sudoku-editor-board")[0]),c(!1)},y=function(e,n){c(!1);var r="";n==l&&(r="Has at least "),r+=n+" solutions",o.show(r)};return b(),f={isVisible:d,isBusy:c,solve:m,check:p,random:v,load:h,save:g,BoardViewModel:a}}),define("app/page.vm",["./loader.vm","./game.vm","./gameEditor.vm","./modal.vm","./inputModal.vm","sudokujs/sudokuWorker"],function(e,o,n,r,t,i){var u=ko.computed(function(){return o.isBusy()||n.isBusy()}),s=function(){o.isVisible()?(o.isVisible(!1),n.isVisible(!0)):(n.isVisible(!1),o.isVisible(!0),o.generate("Medium"))},a=function(){i.abort(),i.start(),setTimeout(function(){o.isBusy(!1),n.isBusy(!1)},1e3)};return e.isBlocked.subscribe(a),e.show("Loading..."),{isBusy:u,switchMode:s,LoaderViewModel:e,GameViewModel:o,GameEditorViewModel:n,ModalViewModel:r,InputModalViewModel:t}}),define("app/effects",[],function(){$(document).ready(function(){function e(){var e=$(document).scrollTop();$(".menu-bullets-container a").each(function(){var o=$(this),n=$(o.attr("href"));n.position().top-t<=e&&n.position().top-t+n.height()>e?($(".menu-bullets-container a").removeClass("active"),o.addClass("active")):o.removeClass("active")})}var o=$(".menu-hidden"),n=$(".menu-button.icon-pull"),r=$(".menu-close");r.click(function(e){e.preventDefault(),o.fadeOut()}),n.click(function(e){e.preventDefault(),o.fadeIn()});var t=75;$(".slow-anchor").click(function(){return $("html, body").animate({scrollTop:$($(this).attr("href")).offset().top-t+2},500),!1}),o.find("a").each(function(){var e=$(this);e.click(function(){o.fadeOut()})}),e(),$(document).on("scroll",e)})}),define("app/ko.customBindings",["./modal.vm"],function(e){var o=function(o,n){var r;return""==n?0:(r=parseInt(n),0==r?(e.show("0 not my kind of number"),-1):r!=r?(e.show("Use numbers!"),-1):-1==o.getPossibleNumbers().indexOf(r)&&r!=o.getNumber()?(e.show("Same number exists in row, column or box."),-1):r)};ko.bindingHandlers.cellBinding={init:function(e,o,n,r,t){var i=o(),u=ko.unwrap(i),s=$(e).find("input"),a=t.$parents[3];s.val(u.getNumber()),u.getNumber()&&a.stylesEnabled&&($(e).addClass("sudoku-cell-blocked"),s.attr("readonly",!0)),ko.utils.registerEventHandler(e,"change",function(){i.notifySubscribers()})},update:function(e,n){var r,t=$(e).find("input"),i=t.val(),u=ko.unwrap(n());r=o(u,i),0==r&&u.setNumber(),r>0&&u.setNumber(r),t.val(u.getNumber())}},ko.bindingHandlers.fade={init:function(){},update:function(e,o){var n=ko.utils.unwrapObservable(o());n?$(e).fadeIn():$(e).fadeOut()}}}),require.config({paths:{app:"app",sudokujs:"sudokujs"}}),require(["app/page.vm","app/effects","app/ko.customBindings"],function(e){infuser.defaults.templateUrl="www/templates",infuser.defaults.templatePrefix="",infuser.defaults.templateSuffix=".tmpl.html",$(document).ready(function(){ko.applyBindings(e)})}),define("main",function(){});